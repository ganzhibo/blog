async function updateSW(){navigator.serviceWorker&&navigator.serviceWorker.getRegistrations().then((async e=>{for(let t of e)await t.update();console.log("Unregistered service workers")})).then((()=>{navigator.serviceWorker.register("/cw.js").then((async e=>{console.log("Registered service worker"),await e.update()}))}))}var titleTime,OriginTitle=document.title;function winResize(){var e=document.documentElement.clientWidth;e<=768?winbox.resize(.95*e+"px","70%").move("center","center"):winbox.resize(.6*e+"px","70%").move("center","center")}function share(){let e=window.location.origin+window.location.pathname;new ClipboardJS(".share",{text:function(){return"标题："+document.title+"\n链接："+e}}),btf.snackbarShow("本页链接已复制到剪切板，快去分享吧~").innerText=document.title.split(" |Xlenco")[0]}function insertAtCursor(e,t){if(document.selection)e.focus(),sel=document.selection.createRange(),sel.text=t,sel.select();else if(e.selectionStart||"0"==e.selectionStart){var n=e.selectionStart,i=e.selectionEnd,o=e.scrollTop;e.value=e.value.substring(0,n)+t+e.value.substring(i,e.value.length),o>0&&(e.scrollTop=o),e.focus(),e.selectionStart=n+t.length,e.selectionEnd=n+t.length}else e.value+=t,e.focus()}document.addEventListener("visibilitychange",(function(){document.hidden?($('[rel="icon"]').attr("href","/funny.ico"),document.title="w(ﾟДﾟ)w 不要走鸭！再看看吧！！",clearTimeout(titleTime)):($('[rel="icon"]').attr("href","/favicon.ico"),document.title="♪(^∇^*) 又见面了！"+OriginTitle,titleTime=setTimeout((function(){document.title=OriginTitle}),2e3))})),window.onkeydown=function(e){123===e.keyCode&&btf.snackbarShow("开发者模式已打开，请遵循GPL协议",!1,3e3),console.warn("开发者模式已打开，请遵循GPL协议")};let rmf={};const box=document.documentElement;function stopMaskScroll(){if(document.getElementById("rightmenu-mask")){document.getElementById("rightmenu-mask").addEventListener("mousewheel",(function(e){rm.hideRightMenu()}),!1)}if(document.getElementById("rightMenu")){document.getElementById("rightMenu").addEventListener("mousewheel",(function(e){rm.hideRightMenu()}),!1)}}function popupMenu(){window.oncontextmenu=function(e){console.log(e.keyCode),$(".rightMenu-group.hide").hide(),document.getSelection().toString()&&$("#menu-text").show(),(document.getElementById("post")||document.getElementById("page"))&&$("#menu-post").show();var t=window.document.body;t=e.target;/^(?:http(s)?:\/\/)?[\w.-]+(?:\.[\w\.-]+)+[\w\-\._~:/?#[\]@!\$&'\*\+,;=.]+$/.test(window.getSelection().toString())&&$("#menu-too").show(),"A"==t.tagName&&($("#menu-to").show(),rmf.open=function(){location.href=t.href},rmf.openWithNewTab=function(){window.open(t.href)},rmf.copyLink=function(){let e=t.href,n=document.createElement("textarea");n.value=e,document.body.appendChild(n),n.select(),document.execCommand("Copy"),document.body.removeChild(n)}),"IMG"==t.tagName?($("#menu-img").show(),rmf.openWithNewTab=function(){window.open(t.src)},rmf.click=function(){t.click()},rmf.copyLink=function(){let e=t.src,n=document.createElement("textarea");n.value=e,document.body.appendChild(n),n.select(),document.execCommand("Copy"),document.body.removeChild(n)}):"TEXTAREA"!=t.tagName&&"INPUT"!=t.tagName||($("#menu-paste").show(),rmf.paste=function(){navigator.permissions.query({name:"clipboard-read"}).then((e=>{"granted"==e.state||"prompt"==e.state?navigator.clipboard.readText().then((e=>{console.log(e),insertAtCursor(t,e)})):alert("请允许读取剪贴板！")}))});let n=e.clientX+10,i=e.clientY,o=$("#rightMenu").width(),a=$("#rightMenu").height();return n+o>window.innerWidth&&(n-=o+10),i+a>window.innerHeight&&(i-=i+a-window.innerHeight),rmf.showRightMenu(!0,i,n),!1},window.addEventListener("click",(function(){rmf.showRightMenu(!1)})),$("#rightmenu-mask").on("click",rmf.hideRightMenu),$("#rightmenu-mask").contextmenu((function(){return rmf.hideRightMenu(),!1})),addLongtabListener(box,popupMenu)}function addLongtabListener(e,t){let n=0;e.ontouchstart=()=>{n=0,n=setTimeout((()=>{t(),n=0}),380)},e.ontouchmove=()=>{clearTimeout(n),n=0},e.ontouchend=()=>{n&&clearTimeout(n)}}function waterfall(e){function t(e,t){var n=window.getComputedStyle(t);return parseFloat(n["margin"+e])||0}function n(e){return e+"px"}function i(e){return parseFloat(e.style.left)}function o(e){return e.clientWidth}function a(e){return function(e){return parseFloat(e.style.top)}(e)+function(e){return e.clientHeight}(e)+t("Bottom",e)}function r(e){return i(e)+o(e)+t("Right",e)}function s(e){e=e.sort((function(e,t){return a(e)===a(t)?i(t)-i(e):a(t)-a(e)}))}function l(t){o(e)!=g&&(t.target.removeEventListener(t.type,arguments.callee),waterfall(e))}"string"==typeof e&&(e=document.querySelector(e));var c=[].map.call(e.children,(function(e){return e.style.position="absolute",e}));e.style.position="relative";var u=[];c.length&&(c[0].style.top="0px",c[0].style.left=n(t("Left",c[0])),u.push(c[0]));for(var d=1;d<c.length;d++){var m=c[d-1],f=c[d];if(!(r(m)+o(f)<=o(e)))break;f.style.top=m.style.top,f.style.left=n(r(m)+t("Left",f)),u.push(f)}for(;d<c.length;d++){s(u);f=c[d];var h=u.pop();f.style.top=n(a(h)+t("Top",f)),f.style.left=n(i(h)),u.push(f)}s(u);var p=u[0];e.style.height=n(a(p)+t("Bottom",p));var g=o(e);window.addEventListener?window.addEventListener("resize",l):document.body.onresize=l}rmf.showRightMenu=function(e,t=0,n=0){let i=$("#rightMenu");i.css("top",t+"px").css("left",n+"px"),e?(i.show(),stopMaskScroll(),$("#rightmenu-mask").attr("style","display: flex")):(i.hide(),$("#rightmenu-mask").attr("style","display: none"))},rmf.switchDarkMode=function(){"light"===("dark"===document.documentElement.getAttribute("data-theme")?"dark":"light")?(activateDarkMode(),saveToLocal.set("theme","dark",2),void 0!==GLOBAL_CONFIG.Snackbar&&btf.snackbarShow(GLOBAL_CONFIG.Snackbar.day_to_night)):(activateLightMode(),saveToLocal.set("theme","light",2),void 0!==GLOBAL_CONFIG.Snackbar&&btf.snackbarShow(GLOBAL_CONFIG.Snackbar.night_to_day)),"function"==typeof utterancesTheme&&utterancesTheme(),"object"==typeof FB&&window.loadFBComment(),window.DISQUS&&document.getElementById("disqus_thread").children.length&&setTimeout((()=>window.disqusReset()),200)},rmf.copyWordsLink=function(){let e=window.location.href,t=document.createElement("textarea");t.value=e,document.body.appendChild(t),t.select(),document.execCommand("Copy"),document.body.removeChild(t),btf.snackbarShow("复制成功！")},rmf.switchReadMode=function(){const e=document.body;e.classList.add("read-mode");const t=document.createElement("button");t.type="button",t.className="fas fa-sign-out-alt exit-readmode",e.appendChild(t),t.addEventListener("click",(function n(){e.classList.remove("read-mode"),t.remove(),t.removeEventListener("click",n)}))},rmf.copySelect=function(){document.execCommand("Copy",!1,null),btf.snackbarShow("✨我宣布你的剪切板已经被我填满了")},rmf.scrollToTop=function(){btf.scrollToDest(0,500)},rmf.translate=function(){document.getElementById("translateLink").click()},document.onkeydown=function(e){17!=(e=e||window.event).keyCode||console.log("你知道的太多了")},navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i)||popupMenu();var percentFlag=!1;function essayScroll(){const e=(document.documentElement.scrollTop||window.pageYOffset)%document.documentElement.clientHeight;result<=99||(result=99),!percentFlag&&e+100>=document.documentElement.clientHeight&&document.querySelector("#waterfall")?setTimeout((()=>{waterfall("#waterfall")}),500):setTimeout((()=>{document.querySelector("#waterfall")&&waterfall("#waterfall")}),500);const t=window.scrollY+document.documentElement.clientHeight;let n=document.getElementById("post-comment")||document.getElementById("footer");(n.offsetTop+n.offsetHeight/2<t||90<result)&&(percentFlag=!0)}function replaceAll(e,t,n){return e.split(t).join(n)}(anzhiyu={diffDate:function(e,t=!1){const n=new Date,i=new Date(e),o=n.getTime()-i.getTime(),a=36e5,r=24*a;let s;if(t){const e=o/r,t=o/a,n=o/6e4;s=o/2592e6>=1?i.toLocaleDateString().replace(/\//g,"-"):e>=1?parseInt(e)+" "+GLOBAL_CONFIG.date_suffix.day:t>=1?parseInt(t)+" "+GLOBAL_CONFIG.date_suffix.hour:n>=1?parseInt(n)+" "+GLOBAL_CONFIG.date_suffix.min:GLOBAL_CONFIG.date_suffix.just}else s=parseInt(o/r);return s},changeTimeInEssay:function(){document.querySelector("#bber")&&document.querySelectorAll("#bber time").forEach((function(e){var t=e,n=t.getAttribute("datetime");t.innerText=anzhiyu.diffDate(n,!0),t.style.display="inline"}))},reflashEssayWaterFall:function(){document.querySelector("#waterfall")&&setTimeout((function(){waterfall("#waterfall"),document.getElementById("waterfall").classList.add("show")}),500)},commentText:function(e){"undefined"!=e&&"null"!=e||(e="好棒！");var t=document.getElementsByClassName("el-textarea__inner")[0],n=document.createEvent("HTMLEvents");if(t){n.initEvent("input",!0,!0);var i=replaceAll(e,"\n","\n> ");t.value="> "+i+"\n\n",t.dispatchEvent(n);var o=document.querySelector("#post-comment").offsetTop;window.scrollTo(0,o-80),t.focus(),t.setSelectionRange(-1,-1),document.getElementById("comment-tips")&&document.getElementById("comment-tips").classList.add("show")}}}).changeTimeInEssay(),anzhiyu.reflashEssayWaterFall();var anzhiyu;percentFlag=!1;function essayScroll(){const e=(document.documentElement.scrollTop||window.pageYOffset)%document.documentElement.clientHeight;result<=99||(result=99),!percentFlag&&e+100>=document.documentElement.clientHeight&&document.querySelector("#waterfall")?setTimeout((()=>{waterfall("#waterfall")}),500):setTimeout((()=>{document.querySelector("#waterfall")&&waterfall("#waterfall")}),500);const t=window.scrollY+document.documentElement.clientHeight;let n=document.getElementById("post-comment")||document.getElementById("footer");(n.offsetTop+n.offsetHeight/2<t||90<result)&&(percentFlag=!0)}function replaceAll(e,t,n){return e.split(t).join(n)}function dark(){window.requestAnimationFrame=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame;var e,t,n,i,o=.05,a=document.getElementById("universe"),r=!0,s="226,225,224",l=[];function c(){e=window.innerWidth,t=window.innerHeight,n=.216*e,a.setAttribute("width",e),a.setAttribute("height",t)}function u(){i.clearRect(0,0,e,t);for(var n=l.length,o=0;o<n;o++){var a=l[o];a.move(),a.fadeIn(),a.fadeOut(),a.draw()}}function d(){this.reset=function(){this.giant=m(3),this.comet=!this.giant&&!r&&m(10),this.x=f(0,e-10),this.y=f(0,t),this.r=f(1.1,2.6),this.dx=f(o,6*o)+(this.comet+1-1)*o*f(50,120)+.1,this.dy=-f(o,6*o)-(this.comet+1-1)*o*f(50,120),this.fadingOut=null,this.fadingIn=!0,this.opacity=0,this.opacityTresh=f(.2,1-.4*(this.comet+1-1)),this.do=f(5e-4,.002)+.001*(this.comet+1-1)},this.fadeIn=function(){this.fadingIn&&(this.fadingIn=!(this.opacity>this.opacityTresh),this.opacity+=this.do)},this.fadeOut=function(){this.fadingOut&&(this.fadingOut=!(this.opacity<0),this.opacity-=this.do/2,(this.x>e||this.y<0)&&(this.fadingOut=!1,this.reset()))},this.draw=function(){if(i.beginPath(),this.giant)i.fillStyle="rgba(180,184,240,"+this.opacity+")",i.arc(this.x,this.y,2,0,2*Math.PI,!1);else if(this.comet){i.fillStyle="rgba("+s+","+this.opacity+")",i.arc(this.x,this.y,1.5,0,2*Math.PI,!1);for(var e=0;e<30;e++)i.fillStyle="rgba("+s+","+(this.opacity-this.opacity/20*e)+")",i.rect(this.x-this.dx/4*e,this.y-this.dy/4*e-2,2,2),i.fill()}else i.fillStyle="rgba(226,225,142,"+this.opacity+")",i.rect(this.x,this.y,this.r,this.r);i.closePath(),i.fill()},this.move=function(){this.x+=this.dx,this.y+=this.dy,!1===this.fadingOut&&this.reset(),(this.x>e-e/4||this.y<0)&&(this.fadingOut=!0)},setTimeout((function(){r=!1}),50)}function m(e){return Math.floor(1e3*Math.random())+1<10*e}function f(e,t){return Math.random()*(t-e)+e}c(),window.addEventListener("resize",c,!1),function(){i=a.getContext("2d");for(var e=0;e<n;e++)l[e]=new d,l[e].reset();u()}(),function e(){"dark"==document.getElementsByTagName("html")[0].getAttribute("data-theme")&&u(),window.requestAnimationFrame(e)}()}(anzhiyu={diffDate:function(e,t=!1){const n=new Date,i=new Date(e),o=n.getTime()-i.getTime(),a=36e5,r=24*a;let s;if(t){const e=o/r,t=o/a,n=o/6e4;s=o/2592e6>=1?i.toLocaleDateString().replace(/\//g,"-"):e>=1?parseInt(e)+" "+GLOBAL_CONFIG.date_suffix.day:t>=1?parseInt(t)+" "+GLOBAL_CONFIG.date_suffix.hour:n>=1?parseInt(n)+" "+GLOBAL_CONFIG.date_suffix.min:GLOBAL_CONFIG.date_suffix.just}else s=parseInt(o/r);return s},changeTimeInEssay:function(){document.querySelector("#bber")&&document.querySelectorAll("#bber time").forEach((function(e){var t=e,n=t.getAttribute("datetime");t.innerText=anzhiyu.diffDate(n,!0),t.style.display="inline"}))},reflashEssayWaterFall:function(){document.querySelector("#waterfall")&&setTimeout((function(){waterfall("#waterfall"),document.getElementById("waterfall").classList.add("show")}),500)},commentText:function(e){"undefined"!=e&&"null"!=e||(e="好棒！");var t=document.getElementsByClassName("el-textarea__inner")[0],n=document.createEvent("HTMLEvents");if(t){n.initEvent("input",!0,!0);var i=replaceAll(e,"\n","\n> ");t.value="> "+i+"\n\n",t.dispatchEvent(n);var o=document.querySelector("#post-comment").offsetTop;window.scrollTo(0,o-80),t.focus(),t.setSelectionRange(-1,-1),document.getElementById("comment-tips")&&document.getElementById("comment-tips").classList.add("show")}},initIndexEssay:function(){setTimeout((()=>{let e=new Swiper(".essay_bar_swiper_container",{passiveListeners:!0,direction:"vertical",loop:!0,autoplay:{disableOnInteraction:!0,delay:3e3},mousewheel:!0}),t=document.getElementById("bbtalk");null!==t&&(t.onmouseenter=function(){e.autoplay.stop()},t.onmouseleave=function(){e.autoplay.start()})}),100)}}).initIndexEssay(),anzhiyu.changeTimeInEssay(),anzhiyu.reflashEssayWaterFall(),dark();var CountUp=function(e,t,n,i,o,a){var r=this;if(r.version=function(){return"1.9.2"},r.options={useEasing:!0,useGrouping:!0,separator:",",decimal:".",easingFn:function(e,t,n,i){return n*(1-Math.pow(2,-10*e/i))*1024/1023+t},formattingFn:function(e){var t,n,i,o,a,s;if(e=e.toFixed(r.decimals),t=(e+="").split("."),n=t[0],i=t.length>1?r.options.decimal+t[1]:"",r.options.useGrouping){for(o="",a=0,s=n.length;a<s;++a)0!==a&&a%3==0&&(o=r.options.separator+o),o=n[s-a-1]+o;n=o}r.options.numerals.length&&(n=n.replace(/[0-9]/g,(function(e){return r.options.numerals[+e]})),i=i.replace(/[0-9]/g,(function(e){return r.options.numerals[+e]})));return r.options.prefix+n+i+r.options.suffix},prefix:"",suffix:"",numerals:[]},a&&"object"==typeof a)for(var s in r.options)a.hasOwnProperty(s)&&null!==a[s]&&(r.options[s]=a[s]);""===r.options.separator?r.options.useGrouping=!1:r.options.separator=""+r.options.separator;for(var l=0,c=["webkit","moz","ms","o"],u=0;u<c.length&&!window.requestAnimationFrame;++u)window.requestAnimationFrame=window[c[u]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[c[u]+"CancelAnimationFrame"]||window[c[u]+"CancelRequestAnimationFrame"];function d(e){return"number"==typeof e&&!isNaN(e)}window.requestAnimationFrame||(window.requestAnimationFrame=function(e,t){var n=(new Date).getTime(),i=Math.max(0,16-(n-l)),o=window.setTimeout((function(){e(n+i)}),i);return l=n+i,o}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(e){clearTimeout(e)}),r.initialize=function(){return!!r.initialized||(r.error="",r.d="string"==typeof e?document.getElementById(e):e,r.d?(r.startVal=Number(t),r.endVal=Number(n),d(r.startVal)&&d(r.endVal)?(r.decimals=Math.max(0,i||0),r.dec=Math.pow(10,r.decimals),r.duration=1e3*Number(o)||2e3,r.countDown=r.startVal>r.endVal,r.frameVal=r.startVal,r.initialized=!0,!0):(r.error="[CountUp] startVal ("+t+") or endVal ("+n+") is not a number",!1)):(r.error="[CountUp] target is null or undefined",!1))},r.printValue=function(e){var t=r.options.formattingFn(e);"INPUT"===r.d.tagName?this.d.value=t:"text"===r.d.tagName||"tspan"===r.d.tagName?this.d.textContent=t:this.d.innerHTML=t},r.count=function(e){r.startTime||(r.startTime=e),r.timestamp=e;var t=e-r.startTime;r.remaining=r.duration-t,r.options.useEasing?r.countDown?r.frameVal=r.startVal-r.options.easingFn(t,0,r.startVal-r.endVal,r.duration):r.frameVal=r.options.easingFn(t,r.startVal,r.endVal-r.startVal,r.duration):r.countDown?r.frameVal=r.startVal-(r.startVal-r.endVal)*(t/r.duration):r.frameVal=r.startVal+(r.endVal-r.startVal)*(t/r.duration),r.countDown?r.frameVal=r.frameVal<r.endVal?r.endVal:r.frameVal:r.frameVal=r.frameVal>r.endVal?r.endVal:r.frameVal,r.frameVal=Math.round(r.frameVal*r.dec)/r.dec,r.printValue(r.frameVal),t<r.duration?r.rAF=requestAnimationFrame(r.count):r.callback&&r.callback()},r.start=function(e){r.initialize()&&(r.callback=e,r.rAF=requestAnimationFrame(r.count))},r.pauseResume=function(){r.paused?(r.paused=!1,delete r.startTime,r.duration=r.remaining,r.startVal=r.frameVal,requestAnimationFrame(r.count)):(r.paused=!0,cancelAnimationFrame(r.rAF))},r.reset=function(){r.paused=!1,delete r.startTime,r.initialized=!1,r.initialize()&&(cancelAnimationFrame(r.rAF),r.printValue(r.startVal))},r.update=function(e){r.initialize()&&(d(e=Number(e))?(r.error="",e!==r.frameVal&&(cancelAnimationFrame(r.rAF),r.paused=!1,delete r.startTime,r.startVal=r.frameVal,r.endVal=e,r.countDown=r.startVal>r.endVal,r.rAF=requestAnimationFrame(r.count))):r.error="[CountUp] update() - new endVal is not a number: "+e)},r.initialize()&&r.printValue(r.startVal)};